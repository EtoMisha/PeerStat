!function(){"use strict";const e=(e,...t)=>(...n)=>t.reduce((e,t)=>t(e),e(...n)),t=(e,n)=>{const r=n||e.length;return(...n)=>{const a=n.length||1;if(r===a)return e(...n);return t((...t)=>e(...n,...t),r-n.length)}},n=e=>t=>(e(t),t),r=e=>{const t=e.split("."),n=(e={},t=[])=>{const r=e[t.shift()];return null==r||0===t.length?r:n(r,t)};return{get:e=>n(e,[...t]),set:(e,n)=>{let r=e;const[a,...s]=t.reverse();for(const e of s.reverse())void 0===r[e]&&(r[e]={},r=r[e]);const o="object"==typeof n&&0===Object.keys(n).length;return r[a]=o?{}:Object.assign(r[a]||{},n),e}}},a=(e,t)=>e===t?0:void 0===e?1:void 0===t?-1:e<t?-1:1;var s;!function(e){e.ASC="asc",e.DESC="desc",e.NONE="none"}(s||(s={}));const o=e=>{const{pointer:t,direction:n="asc",comparator:s=a}=e;if(!t||"none"===n)return e=>[...e];const o=((e,t)=>{const n=r(e).get;return(e,r)=>t(n(e),n(r))})(t,s),c="desc"===n?(e=>(t,n)=>e(n,t))(o):o;return e=>[...e].sort(c)};var c;!function(e){e.BOOLEAN="boolean",e.NUMBER="number",e.DATE="date",e.STRING="string"}(c||(c={}));var i;!function(e){e.INCLUDES="includes",e.IS="is",e.IS_NOT="isNot",e.LOWER_THAN="lt",e.GREATER_THAN="gt",e.GREATER_THAN_OR_EQUAL="gte",e.LOWER_THAN_OR_EQUAL="lte",e.EQUALS="equals",e.NOT_EQUALS="notEquals",e.ANY_OF="anyOf"}(i||(i={}));const l=e=>t=>!e(t),u=e=>t=>Object.is(e,t),g=e=>t=>t<e,d=e=>t=>t>e,E=e=>t=>e===t,f={includes:e=>t=>t.includes(e),is:u,isNot:e(u,l),lt:g,gte:e(g,l),gt:d,lte:e(d,l),equals:E,notEquals:e(E,l),anyOf:e=>t=>e.includes(t)},p=e=>(...t)=>e.every(e=>e(...t)),b=({value:t="",operator:n="includes",type:r})=>{const a=(t=>{switch(t){case c.BOOLEAN:return Boolean;case c.NUMBER:return Number;case c.DATE:return e=>new Date(e);case c.STRING:return e(String,e=>e.toLowerCase());default:return e=>e}})(r),s=e(a,f[n])(t);return e(a,s)},h=t=>{const n=(e=>{const t={};return Object.keys(e).filter(t=>Array.isArray(e[t])).forEach(n=>{const r=e[n].filter(e=>""!==e.value);r.length>0&&(t[n]=r)}),t})(t),a=Object.keys(n).map(t=>{const a=r(t).get,s=n[t].map(b);return e(a,p(s))}),s=p(a);return e=>e.filter(s)};function A(e,...t){let n=m(e.raw[0]);for(const[r,a]of t.entries()){if(a instanceof RegExp)n+=a.source;else{if("string"!=typeof a)throw new Error("Illegal substitution: "+a);n+=a.replace(/[\\^$.*+?()[\]{}|=!<>:-]/g,"\\$&")}n+=m(e.raw[r+1])}let r="";if(n.startsWith("/")){const e=n.lastIndexOf("/");if(0===e)throw new Error("If the `re` string starts with a slash, it must end with a second slash and zero or more flags: "+n);r=n.slice(e+1),n=n.slice(1,e)}return new RegExp(n,r)}function m(e){return e.replace(/\\`/g,"`")}const C=e=>{const{value:t,scope:n=[],escape:a=!1,flags:s=""}=e,o=n.map(e=>r(e).get);if(0===n.length||!t)return e=>e;const c=!0===a?A`/${t}/${s}`:new RegExp(t,s);return e=>e.filter(e=>o.some(t=>c.test(String(t(e)))))},y=e=>({emitter:t})=>{const n={},r={off:e=>(e||Object.keys(n).forEach(e=>r.off(e)),n[e]&&t.off(e,...n[e]),r)};for(const a of Object.keys(e)){const s=e[a];n[a]=[],r[s]=function(...e){return n[a]=n[a].concat(e),t.on(a,...e),r}}return r},S=({page:e=1,size:t}={page:1})=>(n=[])=>{const r=t||n.length,a=(e-1)*r;return n.slice(a,a+r)};var N;!function(e){e.TOGGLE_SORT="TOGGLE_SORT",e.DISPLAY_CHANGED="DISPLAY_CHANGED",e.PAGE_CHANGED="CHANGE_PAGE",e.EXEC_CHANGED="EXEC_CHANGED",e.FILTER_CHANGED="FILTER_CHANGED",e.SUMMARY_CHANGED="SUMMARY_CHANGED",e.SEARCH_CHANGED="SEARCH_CHANGED",e.EXEC_ERROR="EXEC_ERROR"}(N||(N={}));const O=e=>{const{get:n,set:a}=r(e);return{get:n,set:t(a)}},T=({sortFactory:r,tableState:a,data:s,filterFactory:o,searchFactory:c})=>{let i=s.length,l=s;const u=(()=>{const e={},t={on:(n,...r)=>(e[n]=(e[n]||[]).concat(r),t),dispatch(n,...r){const a=e[n]||[];for(const e of a)e(...r);return t},off(n,...r){if(void 0===n)Object.keys(e).forEach(e=>t.off(e));else{const t=e[n]||[];e[n]=r.length?t.filter(e=>!r.includes(e)):[]}return t}};return t})(),g=O("sort"),d=O("slice"),E=O("filter"),f=O("search");u.on("SUMMARY_CHANGED",({filteredCount:e})=>{i=e});const p=e=>Object.assign({},e),b=t(u.dispatch,2),h=e=>(l=e,b("SUMMARY_CHANGED",{page:a.slice.page,size:a.slice.size,filteredCount:e.length})),A=t((t,r,s)=>e(p,n(b(r)),t.set(a))(s)),m=()=>A(d,"CHANGE_PAGE",{page:1}),C=(t,n)=>{const r=e(A(t,n),m,()=>u.exec());return(e={})=>r(e)},y={sort:C(g,"TOGGLE_SORT"),filter:C(E,"FILTER_CHANGED"),search:C(f,"SEARCH_CHANGED"),slice:e(A(d,"CHANGE_PAGE"),()=>u.exec()),exec:({processingDelay:t=20}={processingDelay:20})=>{u.dispatch("EXEC_CHANGED",{working:!0}),setTimeout(()=>{try{const t=o(E.get(a)),i=c(f.get(a)),l=r(g.get(a)),p=S(d.get(a)),b=e(t,i,n(h),l,p)(s);u.dispatch("DISPLAY_CHANGED",b.map(e=>({index:s.indexOf(e),value:e})))}catch(e){u.dispatch("EXEC_ERROR",e)}finally{u.dispatch("EXEC_CHANGED",{working:!1})}},t)},async eval(t=a){const n=r(g.get(t)),i=c(f.get(t)),l=o(E.get(t)),u=S(d.get(t));return e(l,i,n,u)(s).map(e=>({index:s.indexOf(e),value:e}))},onDisplayChange(e){u.on("DISPLAY_CHANGED",e)},getTableState:()=>JSON.parse(JSON.stringify(a)),getMatchingItems:()=>[...l]},N=Object.assign(u,y);return Object.defineProperties(N,{filteredCount:{get:()=>i},length:{get:()=>s.length}}),N},G=y({FILTER_CHANGED:"onFilterChange"});var _;!function(e){e.BOOLEAN="boolean",e.NUMBER="number",e.DATE="date",e.STRING="string"}(_||(_={}));const v=({table:e,pointer:t,operator:n="includes",type:r="string"})=>{const a=G({emitter:e});return Object.assign({filter(a){const s=this.state();return void 0===a?delete s[t]:Object.assign(s,{[t]:[{value:a,operator:n,type:r}]}),e.filter(s)},state:()=>e.getTableState().filter||{}},a)},L=y({SEARCH_CHANGED:"onSearchChange"}),R=y({CHANGE_PAGE:"onPageChange",SUMMARY_CHANGED:"onSummaryChange"}),H=({table:e})=>{let{slice:{page:t,size:n}}=e.getTableState(),r=e.filteredCount,a=n?Math.ceil(r/n):1;const s=R({emitter:e}),o={selectPage:t=>e.slice({page:t,size:n}),selectNextPage:()=>o.selectPage(t+1),selectPreviousPage:()=>o.selectPage(t-1),changePageSize:t=>e.slice({page:1,size:t}),isPreviousPageEnabled:()=>t>1,isNextPageEnabled:()=>a>t,state:()=>Object.assign(e.getTableState().slice,{filteredCount:r,pageCount:a})},c=Object.assign(o,s);return c.onSummaryChange(({page:e,size:s,filteredCount:o})=>{t=e,r=o,a=(n=s)?Math.ceil(r/n):1}),c},D=y({TOGGLE_SORT:"onSortToggle"}),P=["asc","desc"],M=({pointer:e,table:t,cycle:n=!1,debounceTime:r=0})=>{const a=!0===n?["none"].concat(P):[...P].reverse(),s=((e,t)=>{let n=null;return(...r)=>{null!==n&&clearTimeout(n),n=setTimeout(()=>e(...r),t)}})(t.sort,r);let o=0;const c=D({emitter:t}),i=Object.assign({toggle(){const t=a[++o%a.length];return s({pointer:e,direction:t})},state:()=>t.getTableState().sort},c);i.onSortToggle(({pointer:t})=>{o=e!==t?0:o});const{pointer:l,direction:u="asc"}=i.state();return o=l===e?"asc"===u?1:2:0,i},x=y({SUMMARY_CHANGED:"onSummaryChange"}),F=({table:e})=>x({emitter:e}),I=y({EXEC_CHANGED:"onExecutionChange"}),j=({table:e,el:t})=>{const n=(({table:e})=>I({emitter:e}))({table:e});return n.onExecutionChange((function({working:e}){t.classList.remove("st-working"),!0===e&&t.classList.add("st-working")})),n},w=({el:e,table:t,conf:n={}})=>{const r=n.pointer||e.getAttribute("data-st-sort"),a=n.cycle||e.hasAttribute("data-st-sort-cycle"),s=M({pointer:r,table:t,cycle:a});s.onSortToggle(({pointer:t,direction:n})=>{if(e.classList.remove("st-sort-asc","st-sort-desc"),r===t&&"none"!==n){const t="asc"===n?"st-sort-asc":"st-sort-desc";e.classList.add(t)}});return e.addEventListener("click",()=>s.toggle()),s};function z(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout((function(){e(r)}),t)}}const k=({table:e,el:t,delay:n=400,conf:r={}})=>{const a=r.pointer||t.getAttribute("data-st-filter"),s=r.operator||t.getAttribute("data-st-filter-operator")||"includes",o=t.hasAttribute("type")?t.getAttribute("type"):"string";let c=r.type||t.getAttribute("data-st-filter-type");c||(c=["date","number"].includes(o)?o:"string");const i=v({table:e,pointer:a,type:c,operator:s}),l=z(e=>i.filter(t.value),n);return t.addEventListener("input",l),"SELECT"===t.tagName&&t.addEventListener("change",l),i},U=({el:e,table:t,delay:n=400,conf:r={}})=>{const a=r.scope||(e.getAttribute("data-st-search")||"").split(",").map(e=>e.trim()),s=r.flags||e.getAttribute("data-st-search-flags")||"",o=(({table:e,scope:t=[]})=>{const n=L({emitter:e});return Object.assign(n,{search:(n,r={})=>e.search(Object.assign({},{value:n,scope:t},r)),state:()=>e.getTableState().search},n)})({table:t,scope:a}),c=z(()=>{o.search(e.value,{flags:s})},n);e.addEventListener("input",c)};function $({name:{first:e,last:t},gender:n,birthDate:r,size:a}){const s=document.createElement("tr");return s.innerHTML=`<td>${t}</td><td>${e}</td><td>${n}</td><td>${r.toLocaleDateString()}</td><td>${a}</td>`,s}const Y=document.getElementById("table-container"),B=Y.querySelector("tbody"),q=Y.querySelector("[data-st-summary]"),X=(({sortFactory:e=o,filterFactory:t=h,searchFactory:n=C,tableState:r={sort:{},slice:{page:1},filter:{},search:{}},data:a=[]}={sortFactory:o,filterFactory:h,searchFactory:C,tableState:{sort:{},slice:{page:1},filter:{},search:{}},data:[]},...s)=>{const c=T({sortFactory:e,filterFactory:t,tableState:r,data:a,searchFactory:n});return s.reduce((s,o)=>Object.assign(s,o({sortFactory:e,filterFactory:t,searchFactory:n,tableState:r,data:a,table:c})),c)})({data:data,tableState:{sort:{},filter:{},slice:{page:1,size:20},search:{}}}),Q=(({el:e,table:t})=>{const n=(n,r)=>Array.from(e.querySelectorAll(r)).forEach(e=>n({el:e,table:t}));return n(w,"[data-st-sort]"),n(j,"[data-st-loading-indicator]"),n(U,"[data-st-search]"),n(k,"[data-st-filter]"),t})({el:Y,table:X});!function({table:e,el:t}){const n=F({table:e});n.onSummaryChange(({page:e,size:n,filteredCount:r})=>{t.innerHTML=`showing items <strong>${(e-1)*n+(r>0?1:0)}</strong> - <strong>${Math.min(r,e*n)}</strong> of <strong>${r}</strong> matching items`})}({table:X,el:q}),function({minEl:e,maxEl:t,table:n}){let r,a;const s=()=>{const e=[];r&&e.push({value:r,operator:"lte",type:"number"}),a&&e.push({value:a,operator:"gte",type:"number"}),n.filter({size:e})};e.addEventListener("input",z(t=>{a=e.value,s()},400)),t.addEventListener("input",z(e=>{r=t.value,s()},400))}({table:X,minEl:document.getElementById("min-size"),maxEl:document.getElementById("max-size")}),function({table:e,el:t}){const n=document.createElement("button");n.innerHTML="Previous";const r=document.createElement("button");r.innerHTML="Next";const a=document.createElement("span");a.innerHTML="- page 1 -";const s=H({table:e});s.onSummaryChange(({page:e})=>{n.disabled=!s.isPreviousPageEnabled(),r.disabled=!s.isNextPageEnabled(),a.innerHTML=`- ${e} -`}),n.addEventListener("click",()=>s.selectPreviousPage()),r.addEventListener("click",()=>s.selectNextPage()),t.appendChild(n),t.appendChild(a),t.appendChild(r)}({table:X,el:Y.querySelector("[data-st-pagination]")}),Q.onDisplayChange(e=>{B.innerHTML="";for(let t of e){const e=$(t.value,t.index);B.appendChild(e)}}),Q.exec()}();
//# sourceMappingURL=bundle.js.map
